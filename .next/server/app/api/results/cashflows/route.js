"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/results/cashflows/route";
exports.ids = ["app/api/results/cashflows/route"];
exports.modules = {

/***/ "mongodb":
/*!**************************!*\
  !*** external "mongodb" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("mongodb");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fresults%2Fcashflows%2Froute&page=%2Fapi%2Fresults%2Fcashflows%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fresults%2Fcashflows%2Froute.js&appDir=C%3A%5CProjects%5Crenew-pyth%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5Crenew-pyth&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fresults%2Fcashflows%2Froute&page=%2Fapi%2Fresults%2Fcashflows%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fresults%2Fcashflows%2Froute.js&appDir=C%3A%5CProjects%5Crenew-pyth%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5Crenew-pyth&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Projects_renew_pyth_app_api_results_cashflows_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/results/cashflows/route.js */ \"(rsc)/./app/api/results/cashflows/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/results/cashflows/route\",\n        pathname: \"/api/results/cashflows\",\n        filename: \"route\",\n        bundlePath: \"app/api/results/cashflows/route\"\n    },\n    resolvedPagePath: \"C:\\\\Projects\\\\renew-pyth\\\\app\\\\api\\\\results\\\\cashflows\\\\route.js\",\n    nextConfigOutput,\n    userland: C_Projects_renew_pyth_app_api_results_cashflows_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/results/cashflows/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZyZXN1bHRzJTJGY2FzaGZsb3dzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZyZXN1bHRzJTJGY2FzaGZsb3dzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcmVzdWx0cyUyRmNhc2hmbG93cyUyRnJvdXRlLmpzJmFwcERpcj1DJTNBJTVDUHJvamVjdHMlNUNyZW5ldy1weXRoJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDUHJvamVjdHMlNUNyZW5ldy1weXRoJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNnQjtBQUM3RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3JlbmV3YWJsZWFzc2V0cy1uZXh0anMvPzNmOTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcUHJvamVjdHNcXFxccmVuZXctcHl0aFxcXFxhcHBcXFxcYXBpXFxcXHJlc3VsdHNcXFxcY2FzaGZsb3dzXFxcXHJvdXRlLmpzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9yZXN1bHRzL2Nhc2hmbG93cy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3Jlc3VsdHMvY2FzaGZsb3dzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9yZXN1bHRzL2Nhc2hmbG93cy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFByb2plY3RzXFxcXHJlbmV3LXB5dGhcXFxcYXBwXFxcXGFwaVxcXFxyZXN1bHRzXFxcXGNhc2hmbG93c1xcXFxyb3V0ZS5qc1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcmVzdWx0cy9jYXNoZmxvd3Mvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fresults%2Fcashflows%2Froute&page=%2Fapi%2Fresults%2Fcashflows%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fresults%2Fcashflows%2Froute.js&appDir=C%3A%5CProjects%5Crenew-pyth%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5Crenew-pyth&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/results/cashflows/route.js":
/*!********************************************!*\
  !*** ./app/api/results/cashflows/route.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../lib/mongodb */ \"(rsc)/./lib/mongodb.js\");\n// app/api/results/cashflows/route.js\n\n\nasync function GET(request) {\n    try {\n        const client = await _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n        const db = client.db(\"energy_contracts\");\n        // Get URL parameters\n        const { searchParams } = new URL(request.url);\n        const assetIds = searchParams.get(\"assets\")?.split(\",\").map((id)=>parseInt(id));\n        const startDate = searchParams.get(\"startDate\");\n        const endDate = searchParams.get(\"endDate\");\n        const limit = parseInt(searchParams.get(\"limit\")) || 1000;\n        const scenarioId = searchParams.get(\"scenarioId\") // For sensitivity analysis\n        ;\n        // Determine which collection to use\n        let collectionName = \"ASSET_cash_flows\";\n        if (scenarioId && scenarioId.startsWith(\"sensitivity_results\")) {\n            collectionName = \"SENS_Asset_Outputs\";\n        }\n        const collection = db.collection(collectionName);\n        // Build query\n        let query = {};\n        // Filter by scenario if provided\n        if (scenarioId) {\n            query.scenario_id = scenarioId;\n        }\n        // Filter by asset IDs if provided\n        if (assetIds && assetIds.length > 0) {\n            query.asset_id = {\n                $in: assetIds\n            };\n        }\n        // Filter by date range if provided\n        if (startDate || endDate) {\n            query.date = {};\n            if (startDate) {\n                query.date.$gte = new Date(startDate);\n            }\n            if (endDate) {\n                query.date.$lte = new Date(endDate);\n            }\n        }\n        console.log(`Querying collection: ${collectionName} with query:`, query);\n        // Get cash flow data with projection for performance\n        const cashFlows = await collection.find(query, {\n            projection: {\n                asset_id: 1,\n                date: 1,\n                revenue: 1,\n                contractedGreenRevenue: 1,\n                contractedEnergyRevenue: 1,\n                merchantGreenRevenue: 1,\n                merchantEnergyRevenue: 1,\n                opex: 1,\n                capex: 1,\n                equity_capex: 1,\n                debt_capex: 1,\n                equity_cash_flow: 1,\n                cfads: 1,\n                interest: 1,\n                principal: 1,\n                terminal_value: 1,\n                period_type: 1,\n                scenario_id: 1\n            }\n        }).sort({\n            date: 1,\n            asset_id: 1\n        }).limit(limit).toArray();\n        // Get summary statistics\n        const summaryPipeline = [\n            {\n                $match: query\n            },\n            {\n                $group: {\n                    _id: null,\n                    totalRecords: {\n                        $sum: 1\n                    },\n                    totalRevenue: {\n                        $sum: \"$revenue\"\n                    },\n                    totalOpex: {\n                        $sum: \"$opex\"\n                    },\n                    totalCapex: {\n                        $sum: \"$capex\"\n                    },\n                    totalEquityCashFlow: {\n                        $sum: \"$equity_cash_flow\"\n                    },\n                    totalCfads: {\n                        $sum: \"$cfads\"\n                    },\n                    minDate: {\n                        $min: \"$date\"\n                    },\n                    maxDate: {\n                        $max: \"$date\"\n                    },\n                    uniqueAssets: {\n                        $addToSet: \"$asset_id\"\n                    }\n                }\n            }\n        ];\n        const summaryResult = await collection.aggregate(summaryPipeline).toArray();\n        const summary = summaryResult[0] || {\n            totalRecords: 0,\n            totalRevenue: 0,\n            totalOpex: 0,\n            totalCapex: 0,\n            totalEquityCashFlow: 0,\n            totalCfads: 0,\n            minDate: null,\n            maxDate: null,\n            uniqueAssets: []\n        };\n        // Get monthly aggregated data for charts\n        const monthlyPipeline = [\n            {\n                $match: query\n            },\n            {\n                $group: {\n                    _id: {\n                        year: {\n                            $year: \"$date\"\n                        },\n                        month: {\n                            $month: \"$date\"\n                        },\n                        asset_id: \"$asset_id\"\n                    },\n                    revenue: {\n                        $sum: \"$revenue\"\n                    },\n                    opex: {\n                        $sum: \"$opex\"\n                    },\n                    capex: {\n                        $sum: \"$capex\"\n                    },\n                    equity_cash_flow: {\n                        $sum: \"$equity_cash_flow\"\n                    },\n                    cfads: {\n                        $sum: \"$cfads\"\n                    },\n                    contractedGreenRevenue: {\n                        $sum: \"$contractedGreenRevenue\"\n                    },\n                    contractedEnergyRevenue: {\n                        $sum: \"$contractedEnergyRevenue\"\n                    },\n                    merchantGreenRevenue: {\n                        $sum: \"$merchantGreenRevenue\"\n                    },\n                    merchantEnergyRevenue: {\n                        $sum: \"$merchantEnergyRevenue\"\n                    },\n                    date: {\n                        $first: \"$date\"\n                    }\n                }\n            },\n            {\n                $addFields: {\n                    monthYear: {\n                        $dateFromParts: {\n                            year: \"$_id.year\",\n                            month: \"$_id.month\",\n                            day: 1\n                        }\n                    },\n                    asset_id: \"$_id.asset_id\"\n                }\n            },\n            {\n                $sort: {\n                    monthYear: 1,\n                    asset_id: 1\n                }\n            }\n        ];\n        const monthlyData = await collection.aggregate(monthlyPipeline).toArray();\n        // Get asset breakdown\n        const assetBreakdownPipeline = [\n            {\n                $match: query\n            },\n            {\n                $group: {\n                    _id: \"$asset_id\",\n                    totalRevenue: {\n                        $sum: \"$revenue\"\n                    },\n                    totalOpex: {\n                        $sum: \"$opex\"\n                    },\n                    totalCapex: {\n                        $sum: \"$capex\"\n                    },\n                    totalEquityCashFlow: {\n                        $sum: \"$equity_cash_flow\"\n                    },\n                    totalCfads: {\n                        $sum: \"$cfads\"\n                    },\n                    recordCount: {\n                        $sum: 1\n                    },\n                    firstDate: {\n                        $min: \"$date\"\n                    },\n                    lastDate: {\n                        $max: \"$date\"\n                    }\n                }\n            },\n            {\n                $sort: {\n                    _id: 1\n                }\n            }\n        ];\n        const assetBreakdown = await collection.aggregate(assetBreakdownPipeline).toArray();\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            data: cashFlows,\n            monthlyData: monthlyData,\n            assetBreakdown: assetBreakdown,\n            summary: {\n                ...summary,\n                uniqueAssetCount: summary.uniqueAssets.length\n            },\n            metadata: {\n                query: query,\n                collection: collectionName,\n                recordCount: cashFlows.length,\n                limit: limit,\n                hasMore: cashFlows.length === limit,\n                scenarioId: scenarioId\n            }\n        });\n    } catch (error) {\n        console.error(\"Cash flows API error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to fetch cash flows\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST(request) {\n    try {\n        const client = await _lib_mongodb__WEBPACK_IMPORTED_MODULE_1__[\"default\"];\n        const db = client.db(\"energy_contracts\");\n        const body = await request.json();\n        const { assets, dateRange, aggregationType, scenarioId } = body;\n        // Determine which collection to use\n        let collectionName = \"ASSET_cash_flows\";\n        if (scenarioId && scenarioId.startsWith(\"sensitivity_results\")) {\n            collectionName = \"SENS_Asset_Outputs\";\n        }\n        const collection = db.collection(collectionName);\n        // Build aggregation pipeline based on request\n        let pipeline = [];\n        // Match stage\n        let matchStage = {};\n        if (scenarioId) {\n            matchStage.scenario_id = scenarioId;\n        }\n        if (assets && assets.length > 0) {\n            matchStage.asset_id = {\n                $in: assets\n            };\n        }\n        if (dateRange && dateRange.start && dateRange.end) {\n            matchStage.date = {\n                $gte: new Date(dateRange.start),\n                $lte: new Date(dateRange.end)\n            };\n        }\n        if (Object.keys(matchStage).length > 0) {\n            pipeline.push({\n                $match: matchStage\n            });\n        }\n        // Group stage based on aggregation type\n        let groupStage = {\n            _id: null,\n            totalRevenue: {\n                $sum: \"$revenue\"\n            },\n            totalOpex: {\n                $sum: \"$opex\"\n            },\n            totalCapex: {\n                $sum: \"$capex\"\n            },\n            totalEquityCashFlow: {\n                $sum: \"$equity_cash_flow\"\n            },\n            totalCfads: {\n                $sum: \"$cfads\"\n            },\n            avgRevenue: {\n                $avg: \"$revenue\"\n            },\n            avgOpex: {\n                $avg: \"$opex\"\n            },\n            count: {\n                $sum: 1\n            }\n        };\n        if (aggregationType === \"monthly\") {\n            groupStage._id = {\n                year: {\n                    $year: \"$date\"\n                },\n                month: {\n                    $month: \"$date\"\n                }\n            };\n        } else if (aggregationType === \"quarterly\") {\n            groupStage._id = {\n                year: {\n                    $year: \"$date\"\n                },\n                quarter: {\n                    $ceil: {\n                        $divide: [\n                            {\n                                $month: \"$date\"\n                            },\n                            3\n                        ]\n                    }\n                }\n            };\n        } else if (aggregationType === \"yearly\") {\n            groupStage._id = {\n                $year: \"$date\"\n            };\n        } else if (aggregationType === \"by_asset\") {\n            groupStage._id = \"$asset_id\";\n        }\n        pipeline.push({\n            $group: groupStage\n        });\n        pipeline.push({\n            $sort: {\n                _id: 1\n            }\n        });\n        const result = await collection.aggregate(pipeline).toArray();\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            data: result,\n            aggregationType: aggregationType,\n            recordCount: result.length,\n            collection: collectionName,\n            scenarioId: scenarioId\n        });\n    } catch (error) {\n        console.error(\"Cash flows aggregation error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to aggregate cash flows\",\n            details: error.message\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL3Jlc3VsdHMvY2FzaGZsb3dzL3JvdXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxxQ0FBcUM7QUFDSztBQUNTO0FBRTVDLGVBQWVFLElBQUlDLE9BQU87SUFDL0IsSUFBSTtRQUNGLE1BQU1DLFNBQVMsTUFBTUgsb0RBQWFBO1FBQ2xDLE1BQU1JLEtBQUtELE9BQU9DLEVBQUUsQ0FBQ0Msa0JBQXNCO1FBRTNDLHFCQUFxQjtRQUNyQixNQUFNLEVBQUVHLFlBQVksRUFBRSxHQUFHLElBQUlDLElBQUlQLFFBQVFRLEdBQUc7UUFDNUMsTUFBTUMsV0FBV0gsYUFBYUksR0FBRyxDQUFDLFdBQVdDLE1BQU0sS0FBS0MsSUFBSUMsQ0FBQUEsS0FBTUMsU0FBU0Q7UUFDM0UsTUFBTUUsWUFBWVQsYUFBYUksR0FBRyxDQUFDO1FBQ25DLE1BQU1NLFVBQVVWLGFBQWFJLEdBQUcsQ0FBQztRQUNqQyxNQUFNTyxRQUFRSCxTQUFTUixhQUFhSSxHQUFHLENBQUMsYUFBYTtRQUNyRCxNQUFNUSxhQUFhWixhQUFhSSxHQUFHLENBQUMsY0FBYywyQkFBMkI7O1FBRTdFLG9DQUFvQztRQUNwQyxJQUFJUyxpQkFBaUI7UUFDckIsSUFBSUQsY0FBY0EsV0FBV0UsVUFBVSxDQUFDLHdCQUF3QjtZQUM5REQsaUJBQWlCO1FBQ25CO1FBRUEsTUFBTUUsYUFBYW5CLEdBQUdtQixVQUFVLENBQUNGO1FBRWpDLGNBQWM7UUFDZCxJQUFJRyxRQUFRLENBQUM7UUFFYixpQ0FBaUM7UUFDakMsSUFBSUosWUFBWTtZQUNkSSxNQUFNQyxXQUFXLEdBQUdMO1FBQ3RCO1FBRUEsa0NBQWtDO1FBQ2xDLElBQUlULFlBQVlBLFNBQVNlLE1BQU0sR0FBRyxHQUFHO1lBQ25DRixNQUFNRyxRQUFRLEdBQUc7Z0JBQUVDLEtBQUtqQjtZQUFTO1FBQ25DO1FBRUEsbUNBQW1DO1FBQ25DLElBQUlNLGFBQWFDLFNBQVM7WUFDeEJNLE1BQU1LLElBQUksR0FBRyxDQUFDO1lBQ2Qs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QVMsQ0FBQ2lDLFVBQVVwRCxPQUFPO1FBRTNELE9BQU92RCxxREFBWUEsQ0FBQzZGLElBQUksQ0FBQztZQUN2QkMsTUFBTTRCO1lBQ05oQixpQkFBaUJBO1lBQ2pCakIsYUFBYWlDLE9BQU8vRixNQUFNO1lBQzFCSCxZQUFZRjtZQUNaRCxZQUFZQTtRQUNkO0lBRUYsRUFBRSxPQUFPNkUsT0FBTztRQUNkaEUsUUFBUWdFLEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU9sRyxxREFBWUEsQ0FBQzZGLElBQUksQ0FDdEI7WUFBRUssT0FBTztZQUFrQ0MsU0FBU0QsTUFBTUUsT0FBTztRQUFDLEdBQ2xFO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVuZXdhYmxlYXNzZXRzLW5leHRqcy8uL2FwcC9hcGkvcmVzdWx0cy9jYXNoZmxvd3Mvcm91dGUuanM/YjRiMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBhcHAvYXBpL3Jlc3VsdHMvY2FzaGZsb3dzL3JvdXRlLmpzXG5pbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcbmltcG9ydCBjbGllbnRQcm9taXNlIGZyb20gJy4uLy4uLy4uLy4uL2xpYi9tb25nb2RiJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjbGllbnQgPSBhd2FpdCBjbGllbnRQcm9taXNlXG4gICAgY29uc3QgZGIgPSBjbGllbnQuZGIocHJvY2Vzcy5lbnYuTU9OR09EQl9EQilcbiAgICBcbiAgICAvLyBHZXQgVVJMIHBhcmFtZXRlcnNcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICBjb25zdCBhc3NldElkcyA9IHNlYXJjaFBhcmFtcy5nZXQoJ2Fzc2V0cycpPy5zcGxpdCgnLCcpLm1hcChpZCA9PiBwYXJzZUludChpZCkpXG4gICAgY29uc3Qgc3RhcnREYXRlID0gc2VhcmNoUGFyYW1zLmdldCgnc3RhcnREYXRlJylcbiAgICBjb25zdCBlbmREYXRlID0gc2VhcmNoUGFyYW1zLmdldCgnZW5kRGF0ZScpXG4gICAgY29uc3QgbGltaXQgPSBwYXJzZUludChzZWFyY2hQYXJhbXMuZ2V0KCdsaW1pdCcpKSB8fCAxMDAwXG4gICAgY29uc3Qgc2NlbmFyaW9JZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ3NjZW5hcmlvSWQnKSAvLyBGb3Igc2Vuc2l0aXZpdHkgYW5hbHlzaXNcbiAgICBcbiAgICAvLyBEZXRlcm1pbmUgd2hpY2ggY29sbGVjdGlvbiB0byB1c2VcbiAgICBsZXQgY29sbGVjdGlvbk5hbWUgPSAnQVNTRVRfY2FzaF9mbG93cydcbiAgICBpZiAoc2NlbmFyaW9JZCAmJiBzY2VuYXJpb0lkLnN0YXJ0c1dpdGgoJ3NlbnNpdGl2aXR5X3Jlc3VsdHMnKSkge1xuICAgICAgY29sbGVjdGlvbk5hbWUgPSAnU0VOU19Bc3NldF9PdXRwdXRzJ1xuICAgIH1cbiAgICBcbiAgICBjb25zdCBjb2xsZWN0aW9uID0gZGIuY29sbGVjdGlvbihjb2xsZWN0aW9uTmFtZSlcbiAgICBcbiAgICAvLyBCdWlsZCBxdWVyeVxuICAgIGxldCBxdWVyeSA9IHt9XG4gICAgXG4gICAgLy8gRmlsdGVyIGJ5IHNjZW5hcmlvIGlmIHByb3ZpZGVkXG4gICAgaWYgKHNjZW5hcmlvSWQpIHtcbiAgICAgIHF1ZXJ5LnNjZW5hcmlvX2lkID0gc2NlbmFyaW9JZFxuICAgIH1cbiAgICBcbiAgICAvLyBGaWx0ZXIgYnkgYXNzZXQgSURzIGlmIHByb3ZpZGVkXG4gICAgaWYgKGFzc2V0SWRzICYmIGFzc2V0SWRzLmxlbmd0aCA+IDApIHtcbiAgICAgIHF1ZXJ5LmFzc2V0X2lkID0geyAkaW46IGFzc2V0SWRzIH1cbiAgICB9XG4gICAgXG4gICAgLy8gRmlsdGVyIGJ5IGRhdGUgcmFuZ2UgaWYgcHJvdmlkZWRcbiAgICBpZiAoc3RhcnREYXRlIHx8IGVuZERhdGUpIHtcbiAgICAgIHF1ZXJ5LmRhdGUgPSB7fVxuICAgICAgaWYgKHN0YXJ0RGF0ZSkge1xuICAgICAgICBxdWVyeS5kYXRlLiRndGUgPSBuZXcgRGF0ZShzdGFydERhdGUpXG4gICAgICB9XG4gICAgICBpZiAoZW5kRGF0ZSkge1xuICAgICAgICBxdWVyeS5kYXRlLiRsdGUgPSBuZXcgRGF0ZShlbmREYXRlKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zb2xlLmxvZyhgUXVlcnlpbmcgY29sbGVjdGlvbjogJHtjb2xsZWN0aW9uTmFtZX0gd2l0aCBxdWVyeTpgLCBxdWVyeSlcbiAgICBcbiAgICAvLyBHZXQgY2FzaCBmbG93IGRhdGEgd2l0aCBwcm9qZWN0aW9uIGZvciBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IGNhc2hGbG93cyA9IGF3YWl0IGNvbGxlY3Rpb25cbiAgICAgIC5maW5kKHF1ZXJ5LCB7XG4gICAgICAgIHByb2plY3Rpb246IHtcbiAgICAgICAgICBhc3NldF9pZDogMSxcbiAgICAgICAgICBkYXRlOiAxLFxuICAgICAgICAgIHJldmVudWU6IDEsXG4gICAgICAgICAgY29udHJhY3RlZEdyZWVuUmV2ZW51ZTogMSxcbiAgICAgICAgICBjb250cmFjdGVkRW5lcmd5UmV2ZW51ZTogMSxcbiAgICAgICAgICBtZXJjaGFudEdyZWVuUmV2ZW51ZTogMSxcbiAgICAgICAgICBtZXJjaGFudEVuZXJneVJldmVudWU6IDEsXG4gICAgICAgICAgb3BleDogMSxcbiAgICAgICAgICBjYXBleDogMSxcbiAgICAgICAgICBlcXVpdHlfY2FwZXg6IDEsXG4gICAgICAgICAgZGVidF9jYXBleDogMSxcbiAgICAgICAgICBlcXVpdHlfY2FzaF9mbG93OiAxLFxuICAgICAgICAgIGNmYWRzOiAxLFxuICAgICAgICAgIGludGVyZXN0OiAxLFxuICAgICAgICAgIHByaW5jaXBhbDogMSxcbiAgICAgICAgICB0ZXJtaW5hbF92YWx1ZTogMSxcbiAgICAgICAgICBwZXJpb2RfdHlwZTogMSxcbiAgICAgICAgICBzY2VuYXJpb19pZDogMVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnNvcnQoeyBkYXRlOiAxLCBhc3NldF9pZDogMSB9KVxuICAgICAgLmxpbWl0KGxpbWl0KVxuICAgICAgLnRvQXJyYXkoKVxuICAgIFxuICAgIC8vIEdldCBzdW1tYXJ5IHN0YXRpc3RpY3NcbiAgICBjb25zdCBzdW1tYXJ5UGlwZWxpbmUgPSBbXG4gICAgICB7ICRtYXRjaDogcXVlcnkgfSxcbiAgICAgIHtcbiAgICAgICAgJGdyb3VwOiB7XG4gICAgICAgICAgX2lkOiBudWxsLFxuICAgICAgICAgIHRvdGFsUmVjb3JkczogeyAkc3VtOiAxIH0sXG4gICAgICAgICAgdG90YWxSZXZlbnVlOiB7ICRzdW06ICckcmV2ZW51ZScgfSxcbiAgICAgICAgICB0b3RhbE9wZXg6IHsgJHN1bTogJyRvcGV4JyB9LFxuICAgICAgICAgIHRvdGFsQ2FwZXg6IHsgJHN1bTogJyRjYXBleCcgfSxcbiAgICAgICAgICB0b3RhbEVxdWl0eUNhc2hGbG93OiB7ICRzdW06ICckZXF1aXR5X2Nhc2hfZmxvdycgfSxcbiAgICAgICAgICB0b3RhbENmYWRzOiB7ICRzdW06ICckY2ZhZHMnIH0sXG4gICAgICAgICAgbWluRGF0ZTogeyAkbWluOiAnJGRhdGUnIH0sXG4gICAgICAgICAgbWF4RGF0ZTogeyAkbWF4OiAnJGRhdGUnIH0sXG4gICAgICAgICAgdW5pcXVlQXNzZXRzOiB7ICRhZGRUb1NldDogJyRhc3NldF9pZCcgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgXVxuICAgIFxuICAgIGNvbnN0IHN1bW1hcnlSZXN1bHQgPSBhd2FpdCBjb2xsZWN0aW9uLmFnZ3JlZ2F0ZShzdW1tYXJ5UGlwZWxpbmUpLnRvQXJyYXkoKVxuICAgIGNvbnN0IHN1bW1hcnkgPSBzdW1tYXJ5UmVzdWx0WzBdIHx8IHtcbiAgICAgIHRvdGFsUmVjb3JkczogMCxcbiAgICAgIHRvdGFsUmV2ZW51ZTogMCxcbiAgICAgIHRvdGFsT3BleDogMCxcbiAgICAgIHRvdGFsQ2FwZXg6IDAsXG4gICAgICB0b3RhbEVxdWl0eUNhc2hGbG93OiAwLFxuICAgICAgdG90YWxDZmFkczogMCxcbiAgICAgIG1pbkRhdGU6IG51bGwsXG4gICAgICBtYXhEYXRlOiBudWxsLFxuICAgICAgdW5pcXVlQXNzZXRzOiBbXVxuICAgIH1cbiAgICBcbiAgICAvLyBHZXQgbW9udGhseSBhZ2dyZWdhdGVkIGRhdGEgZm9yIGNoYXJ0c1xuICAgIGNvbnN0IG1vbnRobHlQaXBlbGluZSA9IFtcbiAgICAgIHsgJG1hdGNoOiBxdWVyeSB9LFxuICAgICAge1xuICAgICAgICAkZ3JvdXA6IHtcbiAgICAgICAgICBfaWQ6IHtcbiAgICAgICAgICAgIHllYXI6IHsgJHllYXI6ICckZGF0ZScgfSxcbiAgICAgICAgICAgIG1vbnRoOiB7ICRtb250aDogJyRkYXRlJyB9LFxuICAgICAgICAgICAgYXNzZXRfaWQ6ICckYXNzZXRfaWQnXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZXZlbnVlOiB7ICRzdW06ICckcmV2ZW51ZScgfSxcbiAgICAgICAgICBvcGV4OiB7ICRzdW06ICckb3BleCcgfSxcbiAgICAgICAgICBjYXBleDogeyAkc3VtOiAnJGNhcGV4JyB9LFxuICAgICAgICAgIGVxdWl0eV9jYXNoX2Zsb3c6IHsgJHN1bTogJyRlcXVpdHlfY2FzaF9mbG93JyB9LFxuICAgICAgICAgIGNmYWRzOiB7ICRzdW06ICckY2ZhZHMnIH0sXG4gICAgICAgICAgY29udHJhY3RlZEdyZWVuUmV2ZW51ZTogeyAkc3VtOiAnJGNvbnRyYWN0ZWRHcmVlblJldmVudWUnIH0sXG4gICAgICAgICAgY29udHJhY3RlZEVuZXJneVJldmVudWU6IHsgJHN1bTogJyRjb250cmFjdGVkRW5lcmd5UmV2ZW51ZScgfSxcbiAgICAgICAgICBtZXJjaGFudEdyZWVuUmV2ZW51ZTogeyAkc3VtOiAnJG1lcmNoYW50R3JlZW5SZXZlbnVlJyB9LFxuICAgICAgICAgIG1lcmNoYW50RW5lcmd5UmV2ZW51ZTogeyAkc3VtOiAnJG1lcmNoYW50RW5lcmd5UmV2ZW51ZScgfSxcbiAgICAgICAgICBkYXRlOiB7ICRmaXJzdDogJyRkYXRlJyB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgICRhZGRGaWVsZHM6IHtcbiAgICAgICAgICBtb250aFllYXI6IHtcbiAgICAgICAgICAgICRkYXRlRnJvbVBhcnRzOiB7XG4gICAgICAgICAgICAgIHllYXI6ICckX2lkLnllYXInLFxuICAgICAgICAgICAgICBtb250aDogJyRfaWQubW9udGgnLFxuICAgICAgICAgICAgICBkYXk6IDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGFzc2V0X2lkOiAnJF9pZC5hc3NldF9pZCdcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgJHNvcnQ6IHsgbW9udGhZZWFyOiAxLCBhc3NldF9pZDogMSB9XG4gICAgICB9XG4gICAgXVxuICAgIFxuICAgIGNvbnN0IG1vbnRobHlEYXRhID0gYXdhaXQgY29sbGVjdGlvbi5hZ2dyZWdhdGUobW9udGhseVBpcGVsaW5lKS50b0FycmF5KClcbiAgICBcbiAgICAvLyBHZXQgYXNzZXQgYnJlYWtkb3duXG4gICAgY29uc3QgYXNzZXRCcmVha2Rvd25QaXBlbGluZSA9IFtcbiAgICAgIHsgJG1hdGNoOiBxdWVyeSB9LFxuICAgICAge1xuICAgICAgICAkZ3JvdXA6IHtcbiAgICAgICAgICBfaWQ6ICckYXNzZXRfaWQnLFxuICAgICAgICAgIHRvdGFsUmV2ZW51ZTogeyAkc3VtOiAnJHJldmVudWUnIH0sXG4gICAgICAgICAgdG90YWxPcGV4OiB7ICRzdW06ICckb3BleCcgfSxcbiAgICAgICAgICB0b3RhbENhcGV4OiB7ICRzdW06ICckY2FwZXgnIH0sXG4gICAgICAgICAgdG90YWxFcXVpdHlDYXNoRmxvdzogeyAkc3VtOiAnJGVxdWl0eV9jYXNoX2Zsb3cnIH0sXG4gICAgICAgICAgdG90YWxDZmFkczogeyAkc3VtOiAnJGNmYWRzJyB9LFxuICAgICAgICAgIHJlY29yZENvdW50OiB7ICRzdW06IDEgfSxcbiAgICAgICAgICBmaXJzdERhdGU6IHsgJG1pbjogJyRkYXRlJyB9LFxuICAgICAgICAgIGxhc3REYXRlOiB7ICRtYXg6ICckZGF0ZScgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICAkc29ydDogeyBfaWQ6IDEgfVxuICAgICAgfVxuICAgIF1cbiAgICBcbiAgICBjb25zdCBhc3NldEJyZWFrZG93biA9IGF3YWl0IGNvbGxlY3Rpb24uYWdncmVnYXRlKGFzc2V0QnJlYWtkb3duUGlwZWxpbmUpLnRvQXJyYXkoKVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBkYXRhOiBjYXNoRmxvd3MsXG4gICAgICBtb250aGx5RGF0YTogbW9udGhseURhdGEsXG4gICAgICBhc3NldEJyZWFrZG93bjogYXNzZXRCcmVha2Rvd24sXG4gICAgICBzdW1tYXJ5OiB7XG4gICAgICAgIC4uLnN1bW1hcnksXG4gICAgICAgIHVuaXF1ZUFzc2V0Q291bnQ6IHN1bW1hcnkudW5pcXVlQXNzZXRzLmxlbmd0aFxuICAgICAgfSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHF1ZXJ5OiBxdWVyeSxcbiAgICAgICAgY29sbGVjdGlvbjogY29sbGVjdGlvbk5hbWUsXG4gICAgICAgIHJlY29yZENvdW50OiBjYXNoRmxvd3MubGVuZ3RoLFxuICAgICAgICBsaW1pdDogbGltaXQsXG4gICAgICAgIGhhc01vcmU6IGNhc2hGbG93cy5sZW5ndGggPT09IGxpbWl0LFxuICAgICAgICBzY2VuYXJpb0lkOiBzY2VuYXJpb0lkXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdDYXNoIGZsb3dzIEFQSSBlcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnRmFpbGVkIHRvIGZldGNoIGNhc2ggZmxvd3MnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudCA9IGF3YWl0IGNsaWVudFByb21pc2VcbiAgICBjb25zdCBkYiA9IGNsaWVudC5kYihwcm9jZXNzLmVudi5NT05HT0RCX0RCKVxuICAgIFxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxuICAgIGNvbnN0IHsgYXNzZXRzLCBkYXRlUmFuZ2UsIGFnZ3JlZ2F0aW9uVHlwZSwgc2NlbmFyaW9JZCB9ID0gYm9keVxuICAgIFxuICAgIC8vIERldGVybWluZSB3aGljaCBjb2xsZWN0aW9uIHRvIHVzZVxuICAgIGxldCBjb2xsZWN0aW9uTmFtZSA9ICdBU1NFVF9jYXNoX2Zsb3dzJ1xuICAgIGlmIChzY2VuYXJpb0lkICYmIHNjZW5hcmlvSWQuc3RhcnRzV2l0aCgnc2Vuc2l0aXZpdHlfcmVzdWx0cycpKSB7XG4gICAgICBjb2xsZWN0aW9uTmFtZSA9ICdTRU5TX0Fzc2V0X091dHB1dHMnXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGNvbGxlY3Rpb24gPSBkYi5jb2xsZWN0aW9uKGNvbGxlY3Rpb25OYW1lKVxuICAgIFxuICAgIC8vIEJ1aWxkIGFnZ3JlZ2F0aW9uIHBpcGVsaW5lIGJhc2VkIG9uIHJlcXVlc3RcbiAgICBsZXQgcGlwZWxpbmUgPSBbXVxuICAgIFxuICAgIC8vIE1hdGNoIHN0YWdlXG4gICAgbGV0IG1hdGNoU3RhZ2UgPSB7fVxuICAgIGlmIChzY2VuYXJpb0lkKSB7XG4gICAgICBtYXRjaFN0YWdlLnNjZW5hcmlvX2lkID0gc2NlbmFyaW9JZFxuICAgIH1cbiAgICBpZiAoYXNzZXRzICYmIGFzc2V0cy5sZW5ndGggPiAwKSB7XG4gICAgICBtYXRjaFN0YWdlLmFzc2V0X2lkID0geyAkaW46IGFzc2V0cyB9XG4gICAgfVxuICAgIGlmIChkYXRlUmFuZ2UgJiYgZGF0ZVJhbmdlLnN0YXJ0ICYmIGRhdGVSYW5nZS5lbmQpIHtcbiAgICAgIG1hdGNoU3RhZ2UuZGF0ZSA9IHtcbiAgICAgICAgJGd0ZTogbmV3IERhdGUoZGF0ZVJhbmdlLnN0YXJ0KSxcbiAgICAgICAgJGx0ZTogbmV3IERhdGUoZGF0ZVJhbmdlLmVuZClcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgaWYgKE9iamVjdC5rZXlzKG1hdGNoU3RhZ2UpLmxlbmd0aCA+IDApIHtcbiAgICAgIHBpcGVsaW5lLnB1c2goeyAkbWF0Y2g6IG1hdGNoU3RhZ2UgfSlcbiAgICB9XG4gICAgXG4gICAgLy8gR3JvdXAgc3RhZ2UgYmFzZWQgb24gYWdncmVnYXRpb24gdHlwZVxuICAgIGxldCBncm91cFN0YWdlID0ge1xuICAgICAgX2lkOiBudWxsLFxuICAgICAgdG90YWxSZXZlbnVlOiB7ICRzdW06ICckcmV2ZW51ZScgfSxcbiAgICAgIHRvdGFsT3BleDogeyAkc3VtOiAnJG9wZXgnIH0sXG4gICAgICB0b3RhbENhcGV4OiB7ICRzdW06ICckY2FwZXgnIH0sXG4gICAgICB0b3RhbEVxdWl0eUNhc2hGbG93OiB7ICRzdW06ICckZXF1aXR5X2Nhc2hfZmxvdycgfSxcbiAgICAgIHRvdGFsQ2ZhZHM6IHsgJHN1bTogJyRjZmFkcycgfSxcbiAgICAgIGF2Z1JldmVudWU6IHsgJGF2ZzogJyRyZXZlbnVlJyB9LFxuICAgICAgYXZnT3BleDogeyAkYXZnOiAnJG9wZXgnIH0sXG4gICAgICBjb3VudDogeyAkc3VtOiAxIH1cbiAgICB9XG4gICAgXG4gICAgaWYgKGFnZ3JlZ2F0aW9uVHlwZSA9PT0gJ21vbnRobHknKSB7XG4gICAgICBncm91cFN0YWdlLl9pZCA9IHtcbiAgICAgICAgeWVhcjogeyAkeWVhcjogJyRkYXRlJyB9LFxuICAgICAgICBtb250aDogeyAkbW9udGg6ICckZGF0ZScgfVxuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoYWdncmVnYXRpb25UeXBlID09PSAncXVhcnRlcmx5Jykge1xuICAgICAgZ3JvdXBTdGFnZS5faWQgPSB7XG4gICAgICAgIHllYXI6IHsgJHllYXI6ICckZGF0ZScgfSxcbiAgICAgICAgcXVhcnRlcjogeyAkY2VpbDogeyAkZGl2aWRlOiBbeyAkbW9udGg6ICckZGF0ZScgfSwgM10gfSB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChhZ2dyZWdhdGlvblR5cGUgPT09ICd5ZWFybHknKSB7XG4gICAgICBncm91cFN0YWdlLl9pZCA9IHsgJHllYXI6ICckZGF0ZScgfVxuICAgIH0gZWxzZSBpZiAoYWdncmVnYXRpb25UeXBlID09PSAnYnlfYXNzZXQnKSB7XG4gICAgICBncm91cFN0YWdlLl9pZCA9ICckYXNzZXRfaWQnXG4gICAgfVxuICAgIFxuICAgIHBpcGVsaW5lLnB1c2goeyAkZ3JvdXA6IGdyb3VwU3RhZ2UgfSlcbiAgICBwaXBlbGluZS5wdXNoKHsgJHNvcnQ6IHsgX2lkOiAxIH0gfSlcbiAgICBcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb2xsZWN0aW9uLmFnZ3JlZ2F0ZShwaXBlbGluZSkudG9BcnJheSgpXG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIGRhdGE6IHJlc3VsdCxcbiAgICAgIGFnZ3JlZ2F0aW9uVHlwZTogYWdncmVnYXRpb25UeXBlLFxuICAgICAgcmVjb3JkQ291bnQ6IHJlc3VsdC5sZW5ndGgsXG4gICAgICBjb2xsZWN0aW9uOiBjb2xsZWN0aW9uTmFtZSxcbiAgICAgIHNjZW5hcmlvSWQ6IHNjZW5hcmlvSWRcbiAgICB9KVxuICAgIFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Nhc2ggZmxvd3MgYWdncmVnYXRpb24gZXJyb3I6JywgZXJyb3IpXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBhZ2dyZWdhdGUgY2FzaCBmbG93cycsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjbGllbnRQcm9taXNlIiwiR0VUIiwicmVxdWVzdCIsImNsaWVudCIsImRiIiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfREIiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJhc3NldElkcyIsImdldCIsInNwbGl0IiwibWFwIiwiaWQiLCJwYXJzZUludCIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJsaW1pdCIsInNjZW5hcmlvSWQiLCJjb2xsZWN0aW9uTmFtZSIsInN0YXJ0c1dpdGgiLCJjb2xsZWN0aW9uIiwicXVlcnkiLCJzY2VuYXJpb19pZCIsImxlbmd0aCIsImFzc2V0X2lkIiwiJGluIiwiZGF0ZSIsIiRndGUiLCJEYXRlIiwiJGx0ZSIsImNvbnNvbGUiLCJsb2ciLCJjYXNoRmxvd3MiLCJmaW5kIiwicHJvamVjdGlvbiIsInJldmVudWUiLCJjb250cmFjdGVkR3JlZW5SZXZlbnVlIiwiY29udHJhY3RlZEVuZXJneVJldmVudWUiLCJtZXJjaGFudEdyZWVuUmV2ZW51ZSIsIm1lcmNoYW50RW5lcmd5UmV2ZW51ZSIsIm9wZXgiLCJjYXBleCIsImVxdWl0eV9jYXBleCIsImRlYnRfY2FwZXgiLCJlcXVpdHlfY2FzaF9mbG93IiwiY2ZhZHMiLCJpbnRlcmVzdCIsInByaW5jaXBhbCIsInRlcm1pbmFsX3ZhbHVlIiwicGVyaW9kX3R5cGUiLCJzb3J0IiwidG9BcnJheSIsInN1bW1hcnlQaXBlbGluZSIsIiRtYXRjaCIsIiRncm91cCIsIl9pZCIsInRvdGFsUmVjb3JkcyIsIiRzdW0iLCJ0b3RhbFJldmVudWUiLCJ0b3RhbE9wZXgiLCJ0b3RhbENhcGV4IiwidG90YWxFcXVpdHlDYXNoRmxvdyIsInRvdGFsQ2ZhZHMiLCJtaW5EYXRlIiwiJG1pbiIsIm1heERhdGUiLCIkbWF4IiwidW5pcXVlQXNzZXRzIiwiJGFkZFRvU2V0Iiwic3VtbWFyeVJlc3VsdCIsImFnZ3JlZ2F0ZSIsInN1bW1hcnkiLCJtb250aGx5UGlwZWxpbmUiLCJ5ZWFyIiwiJHllYXIiLCJtb250aCIsIiRtb250aCIsIiRmaXJzdCIsIiRhZGRGaWVsZHMiLCJtb250aFllYXIiLCIkZGF0ZUZyb21QYXJ0cyIsImRheSIsIiRzb3J0IiwibW9udGhseURhdGEiLCJhc3NldEJyZWFrZG93blBpcGVsaW5lIiwicmVjb3JkQ291bnQiLCJmaXJzdERhdGUiLCJsYXN0RGF0ZSIsImFzc2V0QnJlYWtkb3duIiwianNvbiIsImRhdGEiLCJ1bmlxdWVBc3NldENvdW50IiwibWV0YWRhdGEiLCJoYXNNb3JlIiwiZXJyb3IiLCJkZXRhaWxzIiwibWVzc2FnZSIsInN0YXR1cyIsIlBPU1QiLCJib2R5IiwiYXNzZXRzIiwiZGF0ZVJhbmdlIiwiYWdncmVnYXRpb25UeXBlIiwicGlwZWxpbmUiLCJtYXRjaFN0YWdlIiwic3RhcnQiLCJlbmQiLCJPYmplY3QiLCJrZXlzIiwicHVzaCIsImdyb3VwU3RhZ2UiLCJhdmdSZXZlbnVlIiwiJGF2ZyIsImF2Z09wZXgiLCJjb3VudCIsInF1YXJ0ZXIiLCIkY2VpbCIsIiRkaXZpZGUiLCJyZXN1bHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/results/cashflows/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/mongodb.js":
/*!************************!*\
  !*** ./lib/mongodb.js ***!
  \************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mongodb */ \"mongodb\");\n/* harmony import */ var mongodb__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mongodb__WEBPACK_IMPORTED_MODULE_0__);\n// lib/mongodb.js\n\nconst uri = \"mongodb+srv://ProjectHalo:5apsFwxTlqN8WHQR@cluster0.quuwlhb.mongodb.net/energy_contracts?retryWrites=true&w=majority&appName=Cluster0\";\nconst options = {};\nlet client;\nlet clientPromise;\nif (false) {}\nif (true) {\n    // In development mode, use a global variable so that the value\n    // is preserved across module reloads caused by HMR (Hot Module Replacement).\n    if (!global._mongoClientPromise) {\n        client = new mongodb__WEBPACK_IMPORTED_MODULE_0__.MongoClient(uri, options);\n        global._mongoClientPromise = client.connect();\n    }\n    clientPromise = global._mongoClientPromise;\n} else {}\n// Export a module-scoped MongoClient promise. By doing this in a\n// separate module, the client can be shared across functions.\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (clientPromise);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvbW9uZ29kYi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxpQkFBaUI7QUFDb0I7QUFFckMsTUFBTUMsTUFBTUMsdUlBQXVCO0FBQ25DLE1BQU1HLFVBQVUsQ0FBQztBQUVqQixJQUFJQztBQUNKLElBQUlDO0FBRUosSUFBSSxLQUF3QixFQUFFLEVBRTdCO0FBRUQsSUFBSUwsSUFBeUIsRUFBZTtJQUMxQywrREFBK0Q7SUFDL0QsNkVBQTZFO0lBQzdFLElBQUksQ0FBQ08sT0FBT0MsbUJBQW1CLEVBQUU7UUFDL0JKLFNBQVMsSUFBSU4sZ0RBQVdBLENBQUNDLEtBQUtJO1FBQzlCSSxPQUFPQyxtQkFBbUIsR0FBR0osT0FBT0ssT0FBTztJQUM3QztJQUNBSixnQkFBZ0JFLE9BQU9DLG1CQUFtQjtBQUM1QyxPQUFPLEVBSU47QUFFRCxpRUFBaUU7QUFDakUsOERBQThEO0FBQzlELGlFQUFlSCxhQUFhQSxFQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVuZXdhYmxlYXNzZXRzLW5leHRqcy8uL2xpYi9tb25nb2RiLmpzP2Q5MjAiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbGliL21vbmdvZGIuanNcbmltcG9ydCB7IE1vbmdvQ2xpZW50IH0gZnJvbSAnbW9uZ29kYidcblxuY29uc3QgdXJpID0gcHJvY2Vzcy5lbnYuTU9OR09EQl9VUklcbmNvbnN0IG9wdGlvbnMgPSB7fVxuXG5sZXQgY2xpZW50XG5sZXQgY2xpZW50UHJvbWlzZVxuXG5pZiAoIXByb2Nlc3MuZW52Lk1PTkdPREJfVVJJKSB7XG4gIHRocm93IG5ldyBFcnJvcignUGxlYXNlIGFkZCB5b3VyIE1vbmdvIFVSSSB0byAuZW52LmxvY2FsJylcbn1cblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAnZGV2ZWxvcG1lbnQnKSB7XG4gIC8vIEluIGRldmVsb3BtZW50IG1vZGUsIHVzZSBhIGdsb2JhbCB2YXJpYWJsZSBzbyB0aGF0IHRoZSB2YWx1ZVxuICAvLyBpcyBwcmVzZXJ2ZWQgYWNyb3NzIG1vZHVsZSByZWxvYWRzIGNhdXNlZCBieSBITVIgKEhvdCBNb2R1bGUgUmVwbGFjZW1lbnQpLlxuICBpZiAoIWdsb2JhbC5fbW9uZ29DbGllbnRQcm9taXNlKSB7XG4gICAgY2xpZW50ID0gbmV3IE1vbmdvQ2xpZW50KHVyaSwgb3B0aW9ucylcbiAgICBnbG9iYWwuX21vbmdvQ2xpZW50UHJvbWlzZSA9IGNsaWVudC5jb25uZWN0KClcbiAgfVxuICBjbGllbnRQcm9taXNlID0gZ2xvYmFsLl9tb25nb0NsaWVudFByb21pc2Vcbn0gZWxzZSB7XG4gIC8vIEluIHByb2R1Y3Rpb24gbW9kZSwgaXQncyBiZXN0IHRvIG5vdCB1c2UgYSBnbG9iYWwgdmFyaWFibGUuXG4gIGNsaWVudCA9IG5ldyBNb25nb0NsaWVudCh1cmksIG9wdGlvbnMpXG4gIGNsaWVudFByb21pc2UgPSBjbGllbnQuY29ubmVjdCgpXG59XG5cbi8vIEV4cG9ydCBhIG1vZHVsZS1zY29wZWQgTW9uZ29DbGllbnQgcHJvbWlzZS4gQnkgZG9pbmcgdGhpcyBpbiBhXG4vLyBzZXBhcmF0ZSBtb2R1bGUsIHRoZSBjbGllbnQgY2FuIGJlIHNoYXJlZCBhY3Jvc3MgZnVuY3Rpb25zLlxuZXhwb3J0IGRlZmF1bHQgY2xpZW50UHJvbWlzZSJdLCJuYW1lcyI6WyJNb25nb0NsaWVudCIsInVyaSIsInByb2Nlc3MiLCJlbnYiLCJNT05HT0RCX1VSSSIsIm9wdGlvbnMiLCJjbGllbnQiLCJjbGllbnRQcm9taXNlIiwiRXJyb3IiLCJnbG9iYWwiLCJfbW9uZ29DbGllbnRQcm9taXNlIiwiY29ubmVjdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/mongodb.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fresults%2Fcashflows%2Froute&page=%2Fapi%2Fresults%2Fcashflows%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fresults%2Fcashflows%2Froute.js&appDir=C%3A%5CProjects%5Crenew-pyth%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CProjects%5Crenew-pyth&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();